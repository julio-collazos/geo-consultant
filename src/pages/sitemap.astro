---
import DefaultLayout from '@layouts/DefaultLayout.astro'
import PageHeader from '@components/PageHeader.astro'
import { Heading, Notification } from 'accessible-astro-components'
import { getCollection } from 'astro:content'

// Get all portfolio projects
const projects = await getCollection('projects')

// Define static pages with their descriptions
const staticPages = [
  {
    title: 'Home',
    url: '/',
    description: 'Welcome to our accessible website featuring modern web development and inclusive design principles.',
  },
  {
    title: 'Projects',
    url: '/projects',
    description: 'A collection of projects showcasing geospatial analysis and data-driven sustainability solutions.',
  },
  {
    title: 'Blog',
    url: '/blog',
    description: 'Articles and insights on environmental intelligence and remote sensing.',
  },
  {
    title: 'Contact',
    url: '/contact',
    description: 'Get in touch for specialized geospatial consulting and collaboration opportunities.',
  },
  {
    title: 'Thank you',
    url: '/thank-you',
    description: 'Confirmation page for successful form submissions and user interactions.',
  },
]

const base = import.meta.env.BASE_URL.replace(/\/$/, '')
function withBase(href: string): string {
  if (href.startsWith('http') || href.startsWith('mailto:') || href.startsWith('#')) return href
  const cleanedHref = href.startsWith('/') ? href : '/' + href
  return base + cleanedHref
}
---

<DefaultLayout
  title="Sitemap"
  description="Complete site map showing all pages, portfolio projects, and sections available on our accessible website."
>
  <PageHeader
    title="Sitemap"
    subtitle="A comprehensive overview of all pages and content available on our website, organized for easy navigation."
    bgType="gradient"
  />

  <section class="my-16">
    <div class="container space-y-12">
      <!-- Main Pages Section -->
      <div>
        <Heading level="h2" class="mb-6">Main pages</Heading>
        <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
          {
            staticPages.map((page) => (
              <article>
                <Heading level="h3" size="h6" class="mb-3">
                  <a href={withBase(page.url)}>{page.title}</a>
                </Heading>
                <p class="mb-3">{page.description}</p>
                <p class="text-xs">
                  URL:{' '}
                  <code class="rounded bg-neutral-100 px-1 py-0.5 text-xs text-neutral-500 dark:bg-neutral-800 dark:text-neutral-500">
                    {page.url}
                  </code>
                </p>
              </article>
            ))
          }
        </div>
      </div>

      <!-- Projects Section -->
      <section class="mb-12">
        <Heading level="h2">Projects</Heading>
        <ul class="list-disc pl-6">
          <li>
            <a href={withBase('/projects')}>Projects Archive</a>
          </li>
        </ul>
        <p class="mb-6">
          Explore our collection of {projects.length} accessibility-focused projects showcasing inclusive design and development
          practices.
        </p>
        <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
          {
            projects.map((project) => (
              <article>
                <Heading level="h3" size="h6" class="mb-3">
                  <a href={withBase(`/projects/${project.id}`)}>{project.data.title}</a>
                  <p class="text-sm mt-1 text-gray-600">
                    <span class="sr-only">URL:</span>
                    <span aria-hidden="true" class="opacity-75">
                      /projects/{project.id}
                    </span>
                  </p>
                </Heading>
                <p class="mb-3">{project.data.description}</p>
                <div class="text-xs">
                  <p class="mb-1">
                    By: <span class="font-medium">{project.data.author}</span>
                  </p>
                  <p>
                    URL:{' '}
                    <code class="rounded bg-neutral-100 px-1 py-0.5 text-xs text-neutral-500 dark:bg-neutral-800 dark:text-neutral-500">
                      /projects/{project.id}
                    </code>
                  </p>
                </div>
              </article>
            ))
          }
        </div>
      </div>

      <!-- Blog Section -->
      <div>
        <Heading level="h2" class="mb-6">Blog</Heading>
        <article>
          <Heading level="h3" size="h6" class="mb-3">
            <a href={withBase('/blog')}> Blog posts </a>
          </Heading>
          <p>
            Discover articles about web accessibility, development best practices, and inclusive design. Our blog
            features dynamic content with pagination for easy browsing.
          </p>
          <div class="text-xs">
            <p>Features: Dynamic content from JSONPlaceholder API</p>
            <p>
              Base URL: <code
                class="rounded bg-neutral-100 px-1 py-0.5 text-xs text-neutral-500 dark:bg-neutral-800 dark:text-neutral-500"
                >/blog</code
              >
            </p>
            <p>
              Individual posts: <code
                class="rounded bg-neutral-100 px-1 py-0.5 text-xs text-neutral-500 dark:bg-neutral-800 dark:text-neutral-500"
                >/blog/[post-title]</code
              >
            </p>
          </div>
        </article>
      </div>

      <!-- Technical Information -->
      <Notification type="info" variant="accent">
        <div class="space-content">
          <Heading level="h2" size="h6" class="mb-4">Technical sitemap information</Heading>
          <ul>
            <li>
              <span class="font-bold">XML Sitemap:</span> An automated XML sitemap is generated at
              <code>/sitemap.xml</code>
              for search engine optimization.
            </li>
            <li>
              <strong>Generated by:</strong> @astrojs/sitemap integration configured in astro.config.mjs
            </li>
            <li>
              <strong>Last updated:</strong> Automatically updated on each build
            </li>
          </ul>
        </div>
      </Notification>
    </div>
  </section>
</DefaultLayout>

<style>
  article {
    border: 1px solid var(--border-color-subtle);
    border-radius: var(--radius-large);
    background-color: var(--background-color);
    padding: 1rem;
  }
</style>
